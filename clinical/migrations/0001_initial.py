# Generated by Django 5.2.1 on 2026-02-01 07:14

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Equipment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('equipment_name', models.CharField(max_length=200, verbose_name='設備名稱')),
                ('equipment_type', models.CharField(choices=[('robot', '復健機器人'), ('wheelchair', '輪椅'), ('walker', '助行器'), ('medical_device', '醫療設備'), ('exercise', '運動器材'), ('other', '其他')], max_length=30)),
                ('manufacturer', models.CharField(blank=True, max_length=100, verbose_name='製造商')),
                ('model_number', models.CharField(blank=True, max_length=100, verbose_name='型號')),
                ('serial_number', models.CharField(max_length=100, unique=True, verbose_name='序號')),
                ('purchase_date', models.DateField(blank=True, null=True, verbose_name='購買日期')),
                ('last_maintenance_date', models.DateField(blank=True, null=True, verbose_name='最後維護日期')),
                ('next_maintenance_date', models.DateField(blank=True, null=True, verbose_name='下次維護日期')),
                ('status', models.CharField(choices=[('available', '可用'), ('in_use', '使用中'), ('maintenance', '維護中'), ('broken', '故障'), ('retired', '報廢')], default='available', max_length=20)),
                ('location', models.CharField(max_length=100, verbose_name='存放位置')),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': '設備',
                'verbose_name_plural': '設備',
                'db_table': 'equipment',
                'ordering': ['equipment_name'],
            },
        ),
        migrations.CreateModel(
            name='CarePlan',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200, verbose_name='計畫名稱')),
                ('description', models.TextField(verbose_name='說明')),
                ('period_start', models.DateField(default=django.utils.timezone.now)),
                ('period_end', models.DateField(blank=True, null=True)),
                ('status', models.CharField(choices=[('draft', '草稿'), ('active', '執行中'), ('on_hold', '暫停'), ('completed', '完成'), ('cancelled', '取消')], default='draft', max_length=20)),
                ('fhir_id', models.CharField(blank=True, max_length=100, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('case_manager', models.ForeignKey(limit_choices_to={'role': 'case_manager'}, on_delete=django.db.models.deletion.CASCADE, related_name='created_care_plans', to=settings.AUTH_USER_MODEL)),
                ('patient', models.ForeignKey(limit_choices_to={'role': 'patient'}, on_delete=django.db.models.deletion.CASCADE, related_name='care_plans', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '照護計畫',
                'verbose_name_plural': '照護計畫',
                'db_table': 'care_plans',
                'ordering': ['-period_start'],
            },
        ),
        migrations.CreateModel(
            name='CarePlanGoal',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('description', models.TextField(verbose_name='目標')),
                ('target_date', models.DateField(blank=True, null=True, verbose_name='目標日期')),
                ('achievement_status', models.CharField(choices=[('in_progress', '進行中'), ('achieved', '已達成'), ('not_achieved', '未達成'), ('sustaining', '維持中')], default='in_progress', max_length=20)),
                ('priority', models.IntegerField(default=5, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(10)], verbose_name='優先度 (1-10)')),
                ('notes', models.TextField(blank=True)),
                ('care_plan', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='goals', to='clinical.careplan')),
            ],
            options={
                'verbose_name': '照護目標',
                'verbose_name_plural': '照護目標',
                'db_table': 'care_plan_goals',
                'ordering': ['priority', 'target_date'],
            },
        ),
        migrations.CreateModel(
            name='CareRecord',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('record_date', models.DateField(default=django.utils.timezone.now)),
                ('record_time', models.TimeField(default=django.utils.timezone.now)),
                ('activity_type', models.CharField(choices=[('bathing', '沐浴協助'), ('dressing', '更衣協助'), ('feeding', '進食協助'), ('mobility', '移動協助'), ('toileting', '如廁協助'), ('exercise', '運動協助'), ('medication', '用藥協助'), ('hygiene', '個人衛生'), ('social', '社交活動'), ('other', '其他')], max_length=20)),
                ('duration_minutes', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(480)])),
                ('description', models.TextField(verbose_name='活動說明')),
                ('patient_response', models.TextField(blank=True, verbose_name='病患反應')),
                ('fhir_id', models.CharField(blank=True, max_length=100, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('caregiver', models.ForeignKey(limit_choices_to={'role': 'caregiver'}, on_delete=django.db.models.deletion.CASCADE, related_name='created_care_records', to=settings.AUTH_USER_MODEL)),
                ('patient', models.ForeignKey(limit_choices_to={'role': 'patient'}, on_delete=django.db.models.deletion.CASCADE, related_name='care_records', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '照護記錄',
                'verbose_name_plural': '照護記錄',
                'db_table': 'care_records',
                'ordering': ['-record_date', '-record_time'],
            },
        ),
        migrations.CreateModel(
            name='EquipmentReservation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('reservation_date', models.DateField(default=django.utils.timezone.now)),
                ('start_time', models.TimeField()),
                ('end_time', models.TimeField()),
                ('purpose', models.TextField(verbose_name='使用目的')),
                ('status', models.CharField(choices=[('pending', '待確認'), ('confirmed', '已確認'), ('in_use', '使用中'), ('completed', '已完成'), ('cancelled', '已取消')], default='pending', max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('equipment', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reservations', to='clinical.equipment')),
                ('patient', models.ForeignKey(blank=True, limit_choices_to={'role': 'patient'}, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='equipment_usage', to=settings.AUTH_USER_MODEL)),
                ('reserved_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='equipment_reservations', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '設備預約',
                'verbose_name_plural': '設備預約',
                'db_table': 'equipment_reservations',
                'ordering': ['reservation_date', 'start_time'],
            },
        ),
        migrations.CreateModel(
            name='IncidentReport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('incident_datetime', models.DateTimeField(default=django.utils.timezone.now)),
                ('incident_type', models.CharField(choices=[('fall', '跌倒'), ('injury', '受傷'), ('medication_error', '用藥錯誤'), ('behavioral', '行為異常'), ('vital_abnormal', '生命徵象異常'), ('equipment', '設備問題'), ('infection', '感染'), ('other', '其他')], max_length=30)),
                ('severity', models.CharField(choices=[('minor', '輕微'), ('moderate', '中度'), ('severe', '嚴重'), ('critical', '危急')], max_length=20)),
                ('description', models.TextField(verbose_name='事件描述')),
                ('immediate_action', models.TextField(verbose_name='立即處置')),
                ('location', models.CharField(blank=True, max_length=100, verbose_name='發生地點')),
                ('status', models.CharField(choices=[('reported', '已通報'), ('under_review', '審查中'), ('action_taken', '已處理'), ('resolved', '已結案')], default='reported', max_length=20)),
                ('follow_up_notes', models.TextField(blank=True, verbose_name='後續追蹤')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('notified_staff', models.ManyToManyField(blank=True, related_name='received_incident_notifications', to=settings.AUTH_USER_MODEL)),
                ('patient', models.ForeignKey(limit_choices_to={'role': 'patient'}, on_delete=django.db.models.deletion.CASCADE, related_name='incidents', to=settings.AUTH_USER_MODEL)),
                ('reported_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reported_incidents', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '異常通報',
                'verbose_name_plural': '異常通報',
                'db_table': 'incident_reports',
                'ordering': ['-incident_datetime'],
            },
        ),
        migrations.CreateModel(
            name='MedicalRecord',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('record_date', models.DateField(default=django.utils.timezone.now)),
                ('record_time', models.TimeField(default=django.utils.timezone.now)),
                ('record_type', models.CharField(choices=[('consultation', '門診'), ('followup', '複診'), ('emergency', '急診'), ('inpatient', '住院')], default='consultation', max_length=20)),
                ('chief_complaint', models.TextField(verbose_name='主訴 (Subjective)')),
                ('objective_findings', models.TextField(blank=True, verbose_name='客觀發現 (Objective)')),
                ('assessment', models.TextField(verbose_name='評估 (Assessment)')),
                ('plan', models.TextField(verbose_name='計畫 (Plan)')),
                ('diagnosis', models.CharField(blank=True, max_length=200, verbose_name='診斷')),
                ('fhir_id', models.CharField(blank=True, max_length=100, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('patient', models.ForeignKey(limit_choices_to={'role': 'patient'}, on_delete=django.db.models.deletion.CASCADE, related_name='medical_records', to=settings.AUTH_USER_MODEL)),
                ('practitioner', models.ForeignKey(limit_choices_to={'role__in': ['doctor', 'therapist']}, on_delete=django.db.models.deletion.CASCADE, related_name='created_medical_records', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '診療記錄',
                'verbose_name_plural': '診療記錄',
                'db_table': 'medical_records',
                'ordering': ['-record_date', '-record_time'],
            },
        ),
        migrations.CreateModel(
            name='Medication',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('medication_name', models.CharField(max_length=200, verbose_name='藥名')),
                ('dosage', models.CharField(max_length=100, verbose_name='劑量')),
                ('route', models.CharField(max_length=50, verbose_name='給藥途徑')),
                ('frequency', models.CharField(choices=[('once', '單次'), ('qd', '每日一次'), ('bid', '每日兩次'), ('tid', '每日三次'), ('qid', '每日四次'), ('q4h', '每4小時'), ('q6h', '每6小時'), ('q8h', '每8小時'), ('q12h', '每12小時'), ('prn', '需要時')], max_length=20, verbose_name='頻率')),
                ('start_date', models.DateField(default=django.utils.timezone.now)),
                ('end_date', models.DateField(blank=True, null=True)),
                ('status', models.CharField(choices=[('active', '使用中'), ('completed', '已完成'), ('discontinued', '已停用'), ('on_hold', '暫停')], default='active', max_length=20)),
                ('indication', models.TextField(verbose_name='適應症')),
                ('special_instructions', models.TextField(blank=True, verbose_name='特別指示')),
                ('fhir_id', models.CharField(blank=True, max_length=100, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('patient', models.ForeignKey(limit_choices_to={'role': 'patient'}, on_delete=django.db.models.deletion.CASCADE, related_name='medications', to=settings.AUTH_USER_MODEL)),
                ('prescribed_by', models.ForeignKey(limit_choices_to={'role': 'doctor'}, on_delete=django.db.models.deletion.CASCADE, related_name='prescribed_medications', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '用藥',
                'verbose_name_plural': '用藥',
                'db_table': 'medications',
                'ordering': ['-start_date'],
            },
        ),
        migrations.CreateModel(
            name='MedicationAdministration',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('scheduled_time', models.DateTimeField(verbose_name='排程時間')),
                ('administered_time', models.DateTimeField(blank=True, null=True, verbose_name='給藥時間')),
                ('status', models.CharField(choices=[('scheduled', '已排程'), ('administered', '已給藥'), ('missed', '漏給'), ('refused', '拒絕'), ('held', '保留')], default='scheduled', max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('administered_by', models.ForeignKey(blank=True, limit_choices_to={'role': 'nurse'}, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='administered_medications', to=settings.AUTH_USER_MODEL)),
                ('medication', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='administrations', to='clinical.medication')),
            ],
            options={
                'verbose_name': '給藥記錄',
                'verbose_name_plural': '給藥記錄',
                'db_table': 'medication_administrations',
                'ordering': ['-scheduled_time'],
            },
        ),
        migrations.CreateModel(
            name='NursingNote',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('note_datetime', models.DateTimeField(default=django.utils.timezone.now)),
                ('note_type', models.CharField(choices=[('admission', '入院評估'), ('shift', '交班記錄'), ('assessment', '護理評估'), ('intervention', '護理措施'), ('progress', '進度記錄'), ('discharge', '出院評估')], max_length=20)),
                ('assessment', models.TextField(verbose_name='評估')),
                ('intervention', models.TextField(verbose_name='措施')),
                ('evaluation', models.TextField(blank=True, verbose_name='評值')),
                ('fhir_id', models.CharField(blank=True, max_length=100, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('nurse', models.ForeignKey(limit_choices_to={'role': 'nurse'}, on_delete=django.db.models.deletion.CASCADE, related_name='written_nursing_notes', to=settings.AUTH_USER_MODEL)),
                ('patient', models.ForeignKey(limit_choices_to={'role': 'patient'}, on_delete=django.db.models.deletion.CASCADE, related_name='nursing_notes', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '護理紀錄',
                'verbose_name_plural': '護理紀錄',
                'db_table': 'nursing_notes',
                'ordering': ['-note_datetime'],
            },
        ),
        migrations.CreateModel(
            name='PatientRecord',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('medical_record_number', models.CharField(max_length=50, unique=True, verbose_name='病歷號')),
                ('admission_date', models.DateField(default=django.utils.timezone.now, verbose_name='入院日期')),
                ('discharge_date', models.DateField(blank=True, null=True, verbose_name='出院日期')),
                ('primary_diagnosis', models.CharField(max_length=200, verbose_name='主要診斷')),
                ('secondary_diagnosis', models.TextField(blank=True, verbose_name='次要診斷')),
                ('status', models.CharField(choices=[('active', '在院'), ('discharged', '已出院'), ('transferred', '已轉院')], default='active', max_length=20, verbose_name='狀態')),
                ('allergies', models.TextField(blank=True, verbose_name='過敏史')),
                ('medical_history', models.TextField(blank=True, verbose_name='病史')),
                ('emergency_contact_name', models.CharField(blank=True, max_length=100, verbose_name='緊急聯絡人')),
                ('emergency_contact_phone', models.CharField(blank=True, max_length=20, verbose_name='緊急聯絡電話')),
                ('notes', models.TextField(blank=True, verbose_name='備註')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('caregiver', models.ForeignKey(blank=True, limit_choices_to={'role': 'caregiver'}, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='cared_patients', to=settings.AUTH_USER_MODEL, verbose_name='照服員')),
                ('case_manager', models.ForeignKey(blank=True, limit_choices_to={'role': 'case_manager'}, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='managed_patients', to=settings.AUTH_USER_MODEL, verbose_name='個管師')),
                ('patient', models.OneToOneField(limit_choices_to={'role': 'patient'}, on_delete=django.db.models.deletion.CASCADE, related_name='patient_record', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '病患記錄',
                'verbose_name_plural': '病患記錄',
                'db_table': 'patient_records',
                'ordering': ['-admission_date'],
            },
        ),
        migrations.CreateModel(
            name='RehabPlan',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('plan_name', models.CharField(max_length=200, verbose_name='計畫名稱')),
                ('description', models.TextField(verbose_name='說明')),
                ('start_date', models.DateField(default=django.utils.timezone.now)),
                ('end_date', models.DateField(blank=True, null=True)),
                ('goals', models.TextField(verbose_name='目標')),
                ('status', models.CharField(choices=[('draft', '草稿'), ('active', '執行中'), ('completed', '已完成'), ('cancelled', '已取消')], default='draft', max_length=20)),
                ('requires_robot', models.BooleanField(default=False, verbose_name='需要機器人')),
                ('sessions_per_week', models.IntegerField(default=3, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(7)], verbose_name='每週次數')),
                ('duration_weeks', models.IntegerField(default=4, validators=[django.core.validators.MinValueValidator(1)], verbose_name='計畫週數')),
                ('notes', models.TextField(blank=True, verbose_name='備註')),
                ('fhir_id', models.CharField(blank=True, max_length=100, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('patient', models.ForeignKey(limit_choices_to={'role': 'patient'}, on_delete=django.db.models.deletion.CASCADE, related_name='rehab_plans', to=settings.AUTH_USER_MODEL)),
                ('therapist', models.ForeignKey(limit_choices_to={'role': 'therapist'}, on_delete=django.db.models.deletion.CASCADE, related_name='created_rehab_plans', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '復健計畫',
                'verbose_name_plural': '復健計畫',
                'db_table': 'rehab_plans',
                'ordering': ['-start_date'],
            },
        ),
        migrations.CreateModel(
            name='RehabSession',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('session_date', models.DateField(default=django.utils.timezone.now)),
                ('session_time', models.TimeField(default=django.utils.timezone.now)),
                ('duration_minutes', models.IntegerField(validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(240)])),
                ('robot_used', models.BooleanField(default=False)),
                ('robot_name', models.CharField(blank=True, max_length=100)),
                ('activities_performed', models.TextField(verbose_name='執行活動')),
                ('patient_response', models.TextField(verbose_name='病患反應')),
                ('progress_score', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(10)], verbose_name='進度評分 (1-10)')),
                ('completed', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('rehab_plan', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='sessions', to='clinical.rehabplan')),
            ],
            options={
                'verbose_name': '復健療程',
                'verbose_name_plural': '復健療程',
                'db_table': 'rehab_sessions',
                'ordering': ['-session_date', '-session_time'],
            },
        ),
        migrations.CreateModel(
            name='VitalSigns',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('recorded_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('systolic_bp', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(50), django.core.validators.MaxValueValidator(250)], verbose_name='收縮壓 (mmHg)')),
                ('diastolic_bp', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(30), django.core.validators.MaxValueValidator(150)], verbose_name='舒張壓 (mmHg)')),
                ('heart_rate', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(30), django.core.validators.MaxValueValidator(200)], verbose_name='心率 (bpm)')),
                ('respiratory_rate', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(8), django.core.validators.MaxValueValidator(40)], verbose_name='呼吸率 (breaths/min)')),
                ('temperature', models.DecimalField(blank=True, decimal_places=1, max_digits=4, null=True, verbose_name='體溫 (°C)')),
                ('spo2', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(70), django.core.validators.MaxValueValidator(100)], verbose_name='血氧飽和度 (%)')),
                ('weight', models.DecimalField(blank=True, decimal_places=1, max_digits=5, null=True, verbose_name='體重 (kg)')),
                ('height', models.DecimalField(blank=True, decimal_places=1, max_digits=5, null=True, verbose_name='身高 (cm)')),
                ('notes', models.TextField(blank=True)),
                ('fhir_id', models.CharField(blank=True, max_length=100, null=True)),
                ('patient', models.ForeignKey(limit_choices_to={'role': 'patient'}, on_delete=django.db.models.deletion.CASCADE, related_name='vital_signs', to=settings.AUTH_USER_MODEL)),
                ('recorded_by', models.ForeignKey(limit_choices_to={'role__in': ['nurse', 'doctor', 'caregiver']}, on_delete=django.db.models.deletion.CASCADE, related_name='recorded_vitals', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '生命徵象',
                'verbose_name_plural': '生命徵象',
                'db_table': 'vital_signs',
                'ordering': ['-recorded_at'],
            },
        ),
    ]
